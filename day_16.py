input = R'''\.........../../..\.\.\................|..-...\........./.......-.....................-...\...--....../..\....
........|............|............-.........|....\.................\-.........../...../....-../....\..........
.-....................\\..................|.\..........\.........../.............................-...-........
............-.....\/...........-........-......................-..-...../...............|................/....
.......\....-...-...............|.............-...................../....-../............./\..........-..\....
..................-.............\.........\........-......./..../..|....|......-/............\.............\..
-...............|.........\........../.\........../......./-..........-...-.....-............................|
.\\...\..........-............./...-|...................../.......-.................-....../.........|........
..................../........................./..\...................\.................-/......./.............
../...................|...../.-..................-.....|....-.|....................../.../\....-....|..\..|.\.
..................|..................................-....|.........\................................./.......
.........-...........-........\..|-...................--.............-.../......./....................\..-....
-..........-.................\.....|......|.\................|../..........\.........\.|.............-....\...
......./....-....|....-..........|........-...-....-.....-............................................/../....
.......\...........|.......\....\.//\.............\...../|....-...../..|....-................/................
.........\........./............\.-.|......./..........................|....\........-.-.............../..|-.|
.............................\......|....-../.....\.....-..../.........................\......|....../...\/...
.../.\.........../................................./.\.\...............\..............\.....|........-........
..................\......-......|..................\................................/.../.|...................
...\\............................\./................../............................-.......-..|...............
/.............\...-....\...//..-..\....-......-.\............../.....|../.........|..../........\......\......
./..........-.........\..-.................-.|...........\.......-.......|...................|../.............
.....-./.\..../.|.............../...........|..../....\...\/..-.........|....-.........|......................
...../.|.............../.....................\\../...|........\........./|-...........\/./.\\.................
..............\...-..............\.|......./........-...............-.-...|..\......-./..........-.......|../.
.....|...............\....|............../................./....../...-........-.....|........\.........||../|
.../................................../...............-......................................../.......-......
......../.........|..../...............|...../..|................./............|.../.....|....|..\........-...
.../................................//-.......\........./......../....-.....-....-............................
........../....................|................................./.-......|.....\........-..............|..|..
........|...-............|.\.../.......................\...\../...........|../\.\-..../|\..|-...\......\....-.
...-.\..../.....||.....\./.-.....\..............-.......\.../...-....|......\...........-.....-....../........
...|-...|..........\.........../.......................-....../...............\.......\.....|.................
....\..../\\..........-........\............................/...........|.........|......|.|...........|...|..
.............\............................../....|..\.\..../....................\..|...|..-............\....-.
.-/|./...\....-\....-...\...............-.../............-..../.--............................|||.............
....../../\\...|..-.................\.............../.|\/............................../.........\.....|......
..../....................\..................../......\............-//.........................................
.............\..../........../........-..............................|...-/....../..|....|.......-......../...
................-.|..\../...|.\..|..-.....-..../...................\..............\........................./.
........................../......\...............................-..../......................-...........-....
........\.-......................./...............\..............................\...../...................\..
..............................\..|..............|\.-..-....-..|..../.........\.............../.-..............
..........................\\./|.........\|\..............\......./.......-.-...................\.......-......
.............|.........-..\..................|......-..|.-|.................--..||............-.|.............
..............\..\.\.\.........-./....../\../|../.......................\-.....\....|.........................
.............................|.........\.....|..............................|.......././-.../.........-./....|
\.....................\.../..................................-......./........../..\.\.................|......
...............-......................../.....................................................................
..../........./........-.....|................/../....\.........../../.././........./......................-..
.......\................/............................................\........../..\.\......|/|\..............
...........\.............................\\......\\..|..-\................../.-.....................-.........
........|../..\...............|......./.................................|......|./....../......-..............
........./................\.............|...............-.........-.....\.............../.\..........|........
.........................|......./....................-......|........\.........................|/............
.\..-.......................................-....|.................................|\./.\.....................
\../................................-.-.....-..................../....../......../\...|..|......../.......\...
........................../..............\|............./..../.................../...\....\/..................
../-.........................\...\......\......................|.......\..\...\...\.................-..|....\.
....-...................\......-........../......../...............|................................/.........
.................................../......|.......|......................................|..\........-........
......|..|....-..................\./.............../.|...............|.|/.......\.\...........................
...............|...........|.....\................................................|................\.....|....
......../...|......../.................../../...........|...|............./.............\..|.../........-.....
.....................-............\...|..........|...-..........|..-..../...-...../......|....................
...\.......\.....-..................................|/.....\......|.....................|.......|......./.-...
.....................|........./...............|.-...........\........|......|...-/............../.-..........
......./....../.......-....-..............\../\.......\................................................|......
................../.......\\.......................|...\........|...\........-....\..-..........\...../..-....
...............................................-.........................\................\............../..\.
....|......../.........\.........-../....-....................\..................|............................
................./.-../\..........-.....|.........\.........\..../.............................|........--/...
................|./...............|.......\....-\........-.....................-.....|..................../-..
...........\........................|../...-./......\...............\........-./......|.................|..\..
.......|-....../...........|..........|............/.............../.|....../...................\.............
...../...../..........|.......................|....................|.........\|............................\..
........-........\......./....\.............//................................./......./...................|..
..-......../...................-...../.........-...................|..........................\....../.-......
./............................\...............................|............|...../.|................|.........
......\................|.............................-.........\.................................../-........\
./-/..........|.................................../........\....\.....\.....................\.\.........|.....
.-............../../........./.........-......\.....................\..\..\..\/......-./.../....|.............
.....|..................-...\||.......\./../........................-.........................-..........\....
...-................/.|........-....................................|..\....-...\......-..|............/......
..........\...............|.|...-.............-.././...................../.../................................
.......\./............./........../..\............\............-\......|......|....|.........../|.............
............\....|...........|...............-........\..|\..-.....-...|....................\..../.......-....
........\.....\...................|......./......-........./....\-...................|................\....-..
../......................../................-...|..........\........../...................................|.\.
.....................-..../......../........./........./.........\.......|/-...........|.........\...../...../
......//..................\.|....|..|..\...\-........./...........\............/..................|...-.....\.
.....-..-....../..................\....\........................|......................../....|........\..|.\.
.........-............\..............\..\.\../............................\..-...-................./-.........
....|./..........\..-.................\..\...../.\...................-................/............|...../....
...\.................../.....-...../.-.././....-/......|..................|................/.............-....
.....\.||.................\................\..|.....|.............\.\-.............-................./........
.......\..........\....................|................/..............|.../..................\...-.-.||......
.....-./..\.\.........................................|......./.............../....|..|.......-........\...\..
.....|............./.....-...................|.\..../-............\.........................-................\
........\/............./......\......|-...|................../.....|-......................./..............\-.
..............-..../.....-..........||.-.....-.../................././.../............\/................./../.
-.....................................|.........-.....|...................|..................../.../..........
.......................-..|................/...........\...........................|.--.....\..........|/..-..
...............\..................../..../.|..........................|.....................|..\...\....--....
....../.......-...............................|....../.........\.-........../.....................\.--...-....
.-......\............/...-........|.....\........../|........................|..........\...|....../-.........
/............................../.....................................\........../|........-...............\..-
.........\........\.|.|\..\.....-..............-.........-...........|........|...|...........-.............||
.-\................\.......|...................................../..................-.-.....|...\..\.|........
\............-/../.......|............./......\\.\./.|......-/.\.\.............\........./|\.....-............'''

lines = input.splitlines()

for a in lines:
    print(a)

##part 1

startPosition = [5,10]
startDirection = 'W' 

def nextPositions(position, direction, lines):
    #print(position, direction)
    if (
        (direction == 'E' and position[1] == len(lines[0]) - 1) or 
        (direction == 'W' and position[1] == 0) or 
        (direction == 'S' and position[0] == len(lines) - 1) or
        (direction == 'N' and position[0] == 0)
        ):
        next = []
    elif direction == 'E':
        next = [position[0],position[1]+1]
    elif direction == 'W':
        next = [position[0],position[1]-1]
    elif direction == 'N':
        next = [position[0]-1,position[1]]
    elif direction == 'S':
        next = [position[0]+1,position[1]]
    #print(next)
    if next == []:
        return None
    if lines[next[0]][next[1]] == '.':
        output = [[next, direction]]
    if lines[next[0]][next[1]] == '\\':
        newDirection = 'W' if direction == 'N' else 'N' if direction == 'W' else 'S' if direction == 'E' else 'E' if direction == 'S' else 'error'
        output = [[next, newDirection]]
    if lines[next[0]][next[1]] == '/':
        newDirection = 'W' if direction == 'S' else 'S' if direction == 'W' else 'N' if direction == 'E' else 'E' if direction == 'N' else 'error'
        output = [[next, newDirection]]
    if lines[next[0]][next[1]] == '|':
        if direction in ['N','S']:
            output = [[next, direction]]
        else:
            output = [[next, 'N'],[next,'S']]
    if lines[next[0]][next[1]] == '-':
        if direction in ['E','W']:
            output = [[next, direction]]
        else:
            output = [[next, 'E'],[next,'W']]
    return output

#print(nextPositions(startPosition, startDirection, lines))



# nextPosAndDir = [[startPosition, startDirection]]
# posAndDirSoFar = []
# posAndDirSoFar += nextPosAndDir

# for i in range(6000):
#     working = []
#     for a in nextPosAndDir:
#         nextUp = nextPositions(a[0],a[1],lines)
#         if nextUp:
#             working += nextPositions(a[0],a[1],lines)
#     nextPosAndDir = [x for x in working]
#     print(nextPosAndDir)
#     if len([x for x in working]) == len([x for x in working if x in posAndDirSoFar]):
#         print('LOOPED')
#         break
#     posAndDirSoFar += [x for x in working if x not in posAndDirSoFar]

# print()
# print(len(set([tuple(x[0]) for x in posAndDirSoFar])))
# print(set([tuple(x[0]) for x in posAndDirSoFar]))

## part 2

def findLoopSize(startPosition, startDirection, lines):

    nextPosAndDir = [[startPosition, startDirection]]
    posAndDirSoFar = []
    posAndDirSoFar += nextPosAndDir

    for i in range(6000):
        working = []
        for a in nextPosAndDir:
            nextUp = nextPositions(a[0],a[1],lines)
            if nextUp:
                working += nextPositions(a[0],a[1],lines)
        nextPosAndDir = [x for x in working if x not in posAndDirSoFar]
        #print(nextPosAndDir)
        if len([x for x in working]) == len([x for x in working if x in posAndDirSoFar]):
            print(f'{startPosition} {startDirection} LOOPED after {i} iterations')
            break
        posAndDirSoFar += [x for x in working if x not in posAndDirSoFar]

    return len(set([tuple(x[0]) for x in posAndDirSoFar])) - 1


startPositions = []
for x in range(len(lines[0])):
    startPositions += [[[-1,x],'S']]
    startPositions += [[[len(lines),x],'N']]
for y in range(1, len(lines)-1):
    startPositions += [[[y,-1],'E']]
    startPositions += [[[y,len(lines[0])],'W']]


mostEnergised = []
for a in startPositions:
    loopSize = findLoopSize(a[0],a[1], lines)
    if len([x for x in mostEnergised if mostEnergised[1] > loopSize]) == 0:
        mostEnergised = [a[0], loopSize]
    
print(mostEnergised)